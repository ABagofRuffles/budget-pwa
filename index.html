<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Basic meta tags -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>QuickBudget</title>
  
  <!-- Content Security Policy to prevent XSS attacks -->
  <!-- Note: 'unsafe-inline' is required for inline styles in HTML, but XSS protection is maintained through safe DOM methods in script.js -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self' data:; connect-src 'self' https://cdn.jsdelivr.net; worker-src 'self' https://cdn.jsdelivr.net blob:; object-src 'none'; base-uri 'self'; form-action 'self';">
  
  <!-- Security headers to prevent clickjacking and referrer leakage -->
  <!-- Note: X-Frame-Options must be set via HTTP headers, not meta tags -->
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
  <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=(), payment=(), usb=(), bluetooth=()">
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  
  <!-- PWA manifest for installable app -->
  <link rel="manifest" href="manifest.json">
  
  <!-- Theme colors for browser UI (light and dark mode) -->
  <meta name="theme-color" content="#0f766e" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#0f172a" media="(prefers-color-scheme: dark)">
  <meta name="color-scheme" content="light dark">
  
  <!-- Stylesheet and PDF.js library for PDF parsing -->
  <link rel="stylesheet" href="styles.css">
  <!-- PDF.js from jsDelivr - using latest available version with SRI for security -->
  <!-- Note: jsDelivr has limited versions. For latest PDF.js, consider using unpkg.com or self-hosting -->
  <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js" 
          integrity="sha512-q+4liFwdPC/bNdhUpZx6aXDx/h77yEQtn4I1slHydcbZK34nLaR3cAeYSJshoxIOq3mjEf7xJE8YWIUHMn+oCQ=="
          crossorigin="anonymous"></script>
</head>
<body>
  <!-- Overlay that appears when side menu is open -->
  <div class="menu-overlay" id="menuOverlay"></div>
  
  <!-- Side navigation menu (hidden by default, slides in from left) -->
  <aside class="side-menu" id="sideMenu">
    <!-- Menu header with close button -->
    <div class="menu-header">
      <h2>Menu</h2>
      <button class="menu-toggle active" id="closeMenuBtn" aria-label="Close menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    
    <!-- Menu navigation items -->
    <nav class="menu-content" id="menuContent">
      <div class="menu-item" id="menuTransactions">Transactions</div>
      <div class="menu-item" id="menuPdfUpload">Import PDF</div>
      <div class="menu-item" id="menuCsvImport">Import CSV</div>
      <!-- Worksheet sections are dynamically populated by JavaScript -->
      <div class="menu-section" id="menuWorksheetSection"></div>
      <div class="menu-item" id="menuExport">Export CSV</div>
      <div class="menu-item menu-item-danger" id="menuClearData">Clear All Data</div>
    </nav>
  </aside>
  
  <!-- Main application content -->
  <main class="app-shell">
    <!-- Fixed header with menu toggle and export button -->
    <header>
      <div class="header-left">
        <button class="menu-toggle" id="menuToggle" aria-label="Open menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
        <h1>QuickBudget</h1>
      </div>
      <div class="header-actions">
        <input type="file" id="csvFileInput" accept=".csv" style="display: none;" />
        <button id="importBtn" class="ghost" style="margin-right: var(--space-sm);">Import CSV</button>
        <button id="exportBtn" class="ghost">Export CSV</button>
      </div>
    </header>

    <!-- Summary totals card showing income, expenses, and net -->
    <div class="card totals-card">
      <div class="totals">
        <div class="pill">
          <div><small>Income</small></div>
          <strong id="incomeTotal">$0.00</strong>
        </div>
        <div class="pill">
          <div><small>Expenses</small></div>
          <strong id="expenseTotal">$0.00</strong>
        </div>
        <div class="pill">
          <div><small>Net</small></div>
          <strong id="netTotal">$0.00</strong>
        </div>
      </div>
    </div>

    <!-- Form card for adding new transactions -->
    <div class="card entry-card">
      <div class="field">
        <label for="desc">Description</label>
        <input id="desc" placeholder="e.g., Groceries, Paycheck" autocomplete="off" />
      </div>

      <div class="row">
        <div class="field">
          <label for="amt">Amount</label>
          <input id="amt" type="number" step="0.01" inputmode="decimal" placeholder="e.g., 45.67" />
        </div>
        <div class="field">
          <label for="type">Type</label>
          <select id="type">
            <option value="expense">Expense (-)</option>
            <option value="income">Income (+)</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label for="cat">Category</label>
          <input id="cat" placeholder="e.g., Food, Rent, Gas" />
        </div>
        <div class="field">
          <label for="date">Date</label>
          <input id="date" type="date" />
        </div>
      </div>

      <button id="addBtn" class="btn">Add</button>
    </div>

    <!-- PDF upload card for importing bank statements -->
    <div class="card pdf-upload-card">
      <h2>Import from PDF</h2>
      <p style="font-size: 13px; color: #64748b; margin-bottom: var(--space-lg);">
        Upload a bank statement or receipt PDF to automatically extract transactions
      </p>
      <!-- Drag and drop area for PDF files -->
      <div class="pdf-upload-area" id="pdfUploadArea">
        <input type="file" id="pdfFileInput" accept=".pdf" />
        <div class="pdf-upload-icon">ðŸ“„</div>
        <div class="pdf-upload-text">Drag and drop a PDF here</div>
        <div class="pdf-upload-hint">or click to browse</div>
      </div>
      <!-- Status message for PDF processing -->
      <div id="pdfStatus" style="margin-top: var(--space-md); font-size: 13px; color: #64748b;"></div>
      <!-- Container for extracted transactions (shown after PDF is processed) -->
      <div id="extractedTransactions" class="extracted-transactions" style="display: none;"></div>
      <!-- Action buttons for adding or clearing extracted transactions -->
      <div id="pdfActions" style="margin-top: var(--space-md); display: none;">
        <button id="addSelectedBtn" class="btn">Add Selected Transactions</button>
        <button id="clearPdfBtn" class="ghost" style="margin-top: var(--space-sm);">Clear</button>
      </div>
    </div>

    <!-- Tabs container for switching between Transactions and Budget Worksheet views -->
    <div class="card tabs-container">
      <!-- Tab navigation buttons -->
      <div class="tabs">
        <button class="tab active" data-tab="transactions">Transactions</button>
        <button class="tab" data-tab="worksheet">Budget Worksheet</button>
      </div>
      
      <!-- Transactions tab content -->
      <div class="tab-content active" id="transactionsTab">
        <!-- Search and filter controls -->
        <div class="row" style="margin-top: var(--space-lg);">
          <div class="field">
            <label for="search">Search</label>
            <input id="search" placeholder="Description or category" />
          </div>
          <div class="field">
            <label for="filterType">Type</label>
            <select id="filterType">
              <option value="all">All</option>
              <option value="income">Income</option>
              <option value="expense">Expense</option>
            </select>
          </div>
        </div>
        <!-- Transaction list (dynamically populated by JavaScript) -->
        <ul id="list" style="margin-top: var(--space-lg);"></ul>
      </div>
      
      <!-- Budget Worksheet tab content -->
      <div class="tab-content" id="worksheetTab">
        <!-- Sub-tabs for worksheet sections (dynamically populated) -->
        <div class="sub-tabs" id="worksheetSubTabs"></div>
        <!-- Worksheet content (dynamically populated) -->
        <div id="worksheet"></div>
      </div>
    </div>
  </main>
  
  <!-- Main application JavaScript -->
  <script src="script.js"></script>
</body>
</html>
